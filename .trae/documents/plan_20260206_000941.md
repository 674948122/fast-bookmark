I will modify `content.js` to dynamically adjust the text color of the primary button based on the brightness of the selected theme color.

1.  **Add Helper Function**:
    - Implement `getContrastColor(hexColor)` inside the main IIFE in `content.js`.
    - This function will calculate the brightness of the hex color and return `#333333` (for light backgrounds) or `#ffffff` (for dark backgrounds).

2.  **Update `updateStyles` Function**:
    - Calculate the active `primaryColor` (based on dark/light mode and settings) *before* constructing the style string.
    - Use `getContrastColor(primaryColor)` to determine the `primaryTextColor`.
    - Add a new CSS variable `--primary-text-color` to the `:host` style block definition.

3.  **Update CSS Rules**:
    - Change the `.btn-primary` CSS rule in the style string to use `color: var(--primary-text-color);` instead of `color: white;`.

This ensures that when the user selects a light theme color, the button text will automatically switch to a dark color for better readability, and vice versa.